<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>R packages by Peter Solymos</title>
    <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,700" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            new Vue({
                el: '#app',
                data: {
                    stats: [],
                    pkgs: []
                },
                created: function () {
                    this.fetchData()
                },
                methods: {
                    fetchData: function () {
                        var xhr = new XMLHttpRequest()
                        var self = this
                        xhr.open('GET', 'https://peter.solymos.org/packages/stats_latest.json')
                        xhr.onload = function () {
                            self.stats = JSON.parse(xhr.responseText)
                            console.log(self.stats)
                            self.pkgs = self.stats.map(function (z) { return z.name[0] })
                            console.log(self.pkgs)
                        }
                        xhr.send()
                    },
                    plotTs: function(pkg) {
                        return this.stats.filter(function (z) { return z.name == pkg })
                    }
                }
            })
        })
    </script>
</head>
<body>
<div id="app">
    <h1>R packages by Peter Solymos</h1>
    <div v-for="pkg in pkgs">
        <!--<p>{{ stats.filter(function (z) { return z.name == pkg }) }}</p>-->
        
        <p>{{ plotTs(pkg) }}</p>
    </div>
</div>
</body>
</html>
